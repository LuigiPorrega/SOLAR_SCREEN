@defer (when fundas) {
  <div class="container my-5">

    <!-- BÃºsqueda en vivo -->
    <div class="row mb-3">
      <div class="col-md-6 mx-auto">
        <input
          type="text"
          [(ngModel)]="nombreABuscar"
          (ngModelChange)="onBuscar()"
          class="form-control"
          placeholder="ðŸ” Buscar funda por nombre..."
        />
      </div>
    </div>

    <!-- Contador de resultados -->
    <div class="text-center mb-4" *ngIf="fundasFiltradas.length > 0">
      <span class="text-muted">ðŸ”Ž {{ fundasFiltradas.length }} fundas encontradas</span>
    </div>

    <!-- Tarjetas de selecciÃ³n -->
    <div class="row my-4 justify-content-center">
      <!-- Funda Expandible -->
      <div class="col-12 col-md-5 mb-3">
        <div class="card h-100 text-center tipo-card"
             [ngClass]="{'selected': tipoSeleccionado === 'Expansible'}"
             (click)="onTipoChange('Expansible')">
          <div class="card-body">
            <h4 class="card-title">ðŸ“¦ Fundas Desplegables</h4>
          </div>
        </div>
      </div>

      <!-- Funda Fija -->
      <div class="col-12 col-md-5 mb-3">
        <div class="card h-100 text-center tipo-card"
             [ngClass]="{'selected': tipoSeleccionado === 'Fija'}"
             (click)="onTipoChange('Fija')">
          <div class="card-body">
            <h4 class="card-title">ðŸ§± Fundas Fijas</h4>
          </div>
        </div>
      </div>
    </div>

    <!-- PaginaciÃ³n -->
    <div class="col-md-12 d-flex justify-content-center my-4" *ngIf="totalPages > 1">
      <ngb-pagination
        [collectionSize]="totalItems"
        [page]="currentPage"
        [pageSize]="perPage"
        [maxSize]="5"
        [rotate]="true"
        [ellipses]="true"
        [boundaryLinks]="true"
        (pageChange)="cambiarPagina($event)">
      </ngb-pagination>
    </div>

    <!-- Resultados -->
    <div class="container mt-4">
      <h2>Listado de Fundas</h2>

      <div *ngIf="fundasPaginadas.length === 0" class="text-center my-4">
        <p class="text-muted">No se encontraron fundas con los criterios seleccionados.</p>
      </div>

      <div class="row" *ngIf="fundasPaginadas.length > 0">
        <div class="col-md-4 mb-4" *ngFor="let funda of fundasPaginadas">
          <div class="card h-100 shadow-sm">
            <img [src]="funda.ImagenURL" class="card-img-top" [alt]="funda.Nombre" />
            <div class="card-body d-flex flex-column justify-content-between">
              <h5 class="card-title">{{ funda.Nombre }}</h5>
              <p><strong>Capacidad:</strong> {{ funda.CapacidadCarga }} mAh</p>
              <p><strong>Precio:</strong> {{ funda.Precio | currency:'EUR':'symbol' }}</p>
              <p><strong>Expansible:</strong> {{ funda.Expansible === 1 ? 'SÃ­' : 'No' }}</p>
              <p><strong>Tipo:</strong> {{ funda.TipoFunda }}</p>
              <button class="btn btn-outline-primary mt-2 w-100" (click)="agregarAlCarrito(funda)">
                <fa-icon [icon]="faCartPlus"></fa-icon> AÃ±adir al carrito
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>



    <!-- Toast -->
    @if (toastShow) {
      <div class="toast show {{ toast.color }} position-fixed top-0 end-0 m-3 shadow" style="z-index: 1200;">
        <div class="toast-body">
          {{ toast.body }}
        </div>
      </div>
    }
  </div>
}

@placeholder () {
  <div class="d-flex flex-column align-items-center justify-content-center py-5">
    <div class="spinner-border text-warning" role="status" style="width: 3rem; height: 3rem;">
      <span class="visually-hidden">Cargando fundas...</span>
    </div>
    <p class="text-warning mt-3">Cargando fundas, ajustando bolsillosâ€¦</p>
  </div>
}
