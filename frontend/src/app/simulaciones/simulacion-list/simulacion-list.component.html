<div class="container mt-4">
  <h2 class="text-center mb-2">Ãšltimas Simulaciones</h2>
  <!-- Spinner mientras carga -->
  <div *ngIf="isLoading" class="text-center my-5">
    <div class="spinner-border text-primary" role="status" style="width: 4rem; height: 4rem;">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-2 text-muted">Cargando simulaciones...</p>
  </div>

  <!-- BotÃ³n para crear simulaciÃ³n -->
  <div class="text-center mb-3 mt-4">
    <a routerLink="/simulaciones/create" class="btn btn-success">
      âœ¨ Realiza tu propia SimulaciÃ³n
    </a>
  </div>

  <section class="recent-simulations mt-4 mb-4" *ngIf="!isLoading">
    <h2 class="text-center text-gradient ">ðŸ”‹ Todas las Simulaciones</h2>
    <div class="row mt-4 justify-content-center">
      <p *ngIf="simulaciones?.length === 0">No hay simulaciones registradas.</p>

      <div class="col-md-4" *ngFor="let sim of simulaciones">
        <div class="sim-card glass p-4 shadow mb-4 text-center">
          <div class="progress-circle mx-auto mb-3">
            <svg width="100" height="100">
              <circle cx="50" cy="50" r="45" stroke="#ccc" stroke-width="10" fill="none" />
              <circle
                cx="50"
                cy="50"
                r="45"
                [attr.stroke]="sim.color === 'success' ? '#28a745' : sim.color === 'warning' ? '#ffc107' : '#dc3545'"
                stroke-width="10"
                fill="none"
                stroke-dasharray="282"
                [attr.stroke-dashoffset]="282 - (sim.porcentajeCarga * 282 / 100)"
                stroke-linecap="round"
                transform="rotate(-90 50 50)"
              />
            </svg>
            <div class="progress-label">{{ sim.porcentajeCarga }}%</div>
          </div>

          <div class="mt-3">
            <p class="fw-semibold mb-1">
              <fa-icon [icon]="sim.CondicionLuz?.includes('solar') ? faSun : faLightbulb" class="me-2"></fa-icon>
              <span *ngIf="sim.CondicionLuz">{{ sim.CondicionLuz }}</span>
            </p>
            <p class="text-muted mb-1">
              <fa-icon [icon]="faCalendarAlt" class="me-2"></fa-icon>
              SimulaciÃ³n realizada el <strong>{{ sim.Fecha | date: 'mediumDate' }}</strong>
            </p>
            <p class="text-info mb-1">âš¡ Tiempo estimado: <strong>{{ sim.Tiempo }}h</strong></p>
            <p class="text-success">ðŸ”‹ Carga alcanzada: <strong>{{ sim.porcentajeCarga }}%</strong></p>
          </div>

          <!-- BotÃ³n PDF dentro de la card -->
          <div class="mt-3">
            <button
              *ngIf="isLoggedIn"
              (click)="descargarSimulacionPDF(sim)"
              class="btn btn-outline-primary btn-sm"
            >
              <i class="fas fa-file-pdf me-1"></i> Descargar PDF
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
